python pyspark queries - 

pyspark \
--master yarn \
--deploy-mode client \
--num-executors 15 \
--executor-memory 20g \
--driver-memory 5g \
--executor-cores 3 \
--conf spark.files.ignoreMissingFiles=True \
--conf spark.shuffle.service.enabled=false \
--conf spark.driver.maxResultSize=16g \
--jars '/opt/mapr/sqoop/sqoop-1.4.7/lib/jtds-1.3.1.jar' \
--conf spark.sql.debug.maxToStringFields=-1 \
--conf spark.shuffle.service.enabled=false \
--conf spark.sql.analyzer.failAmbiguousSelfJoin=false \
--conf spark.sql.legacy.charVarcharAsString=true \
--conf spark.sql.hive.convertMetastoreParquet=False \
--conf spark.unsafe.sorter.spill.read.ahead.enabled=false \
--conf spark.executor.memoryOverhead=4096M \
--conf spark.sql.parquet.writeLegacyFormat=true \
--conf spark.hadoop.hive.exec.dynamic.partition=true \
--conf spark.hadoop.hive.exec.dynamic.partition.mode=nonstrict \
--conf spark.port.maxRetries=100 \
--queue opsictm_q1.models_sq1





https://platform.openai.com/docs/guides/prompt-engineering/six-strategies-for-getting-better-results





final_loc=/mapr/datalake/optum/optuminsight/opsirsch1/opsiqra/developer/mpatra10
script=/mapr/datalake/optum/optuminsight/opsirsch1/opsiqra/prod/attribution/consumption/external/hive_database

find $script/reporting_center_prod_external.db -maxdepth 2 -type d -printf "%p,%u\n" > $final_loc/reporting_center_prod_external_tables_user_details.txt & 
du -h --max-depth=2 -b --time $script/reporting_center_prod_external.db > $final_loc/reporting_center_prod_external_tables_size_details.txt & 

echo "reporting_center_prod_external done"

script=/mapr/datalake/optum/optuminsight/opsirsch1/opsiqra/prod/attribution/consumption/internal/hive_database

find $script/reporting_center_prod_internal.db -maxdepth 2 -type d -printf "%p,%u\n" >> $final_loc/reporting_center_prod_internal_tables_user_details.txt & 
du -h --max-depth=2 -b --time $script/reporting_center_prod_internal.db >> $final_loc/reporting_center_prod_internal_tables_size_details.txt & 

echo "reporting_center_prod_internal done"

script=/mapr/datalake/optum/optuminsight/opsirsch1/opsiqra/prod/attribution/transformation/internal/hive_database/

find $script/rc_transformeddata_prod_internal.db -maxdepth 2 -type d -printf "%p,%u\n" >> $final_loc/rc_transformeddata_prod_internal_tables_user_details.txt & 
du -h --max-depth=2 -b --time $script/rc_transformeddata_prod_internal.db >> $final_loc/rc_transformeddata_prod_internal_tables_size_details.txt & 


echo "rc_transformeddata_prod_internal done"


script=/mapr/datalake/optum/optuminsight/opsirsch1/opsiqra/prod/attribution/transformation/external/hive_database/

find $script/rc_transformeddata_prod_external.db -maxdepth 2 -type d -printf "%p,%u\n" >> $final_loc/rc_transformeddata_prod_external_tables_user_details.txt & 
du -h --max-depth=2 -b --time $script/rc_transformeddata_prod_external.db >> $final_loc/rc_transformeddata_prod_external_tables_size_details.txt & 


echo "rc_transformeddata_prod_external done"
